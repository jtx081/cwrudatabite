<!DOCTYPE html>
<head>
    
    <html xmlns:th="http://www.thymeleaf.org">
    <meta charset="utf-8">
    <meta name="description" content="UI-1">
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/charts.css">
 
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0/dist/Chart.min.js"></script>
    <title>Charts</title>
    
</head>

<body>
    <h1>Select your charts</h1>
    <p>All fields are optional, but allow for more customization.</p>

    <!-- Display checkboxes -->
    <form>
        <div class="polarAreaChart">
            <input type="checkbox" id="polarArea" name="polarArea" onclick="createPolarAreaFields();">
            <label for="polarArea">Polar area chart</label>
        </div>

        <div class="polarAreaTitle" id="paTitle"></div>


        <div class="histogramChart">
            <input type="checkbox" id="histogram" name="histogram" onclick="createHistogramTitle();">
            <label for="histogram">Histogram</label>
        </div>

        <div class="histogramTitle" id="hTitle"></div>


        <div class="lineGraphChart">
            <input type="checkbox" id="lineGraph" name="lineGraph" onclick="createLineGraphFields();">
            <label for="lineGraph">Line graph</label>
        </div>

        <div class="lineGraphTitle" id="lgTitle"></div>


        <div class="scatterPlotChart">
            <input type="checkbox" id="scatterPlot" name="scatterPlot" onclick="createScatterPlotFields();">
            <label for="scatterPlot">Scatter plot</label>
        </div>

        <div class="scatterPlot" id="spTitle"></div>


        <div class="submitButton">
            <button type="submit" class="btn btn-primary" id="generateCharts" onClick="generate();return false;">Generate Charts</button>
        </div>
    </form>

    <hr>

    <!-- Position generated plots on the page -->
    <div class="chartPositions">

        <div class="innerPositions">
            <canvas id="pa"></canvas>
        </div>
        <div id="paImage"></div>


        <div class="innerPositions">
            <canvas id="h"></canvas>
        </div>
        <div id="hImage"></div>


        <div class="innerPositions">
            <canvas id="lg"></canvas>
        </div>
        <div id="lgImage"></div>


        <div class="innerPositions">
            <canvas id="sp"></canvas>
        </div>
        <div id="spImage"></div>
        
    </div>

    <script>
        // Data
        //var data = 

        // Global chart values
        var polarArea;
        var histogram;
        var lineGraph;
        var scatterPlot;

        var paIMG;
        var hIMG;
        var lgIMG;
        var spIMG;

        // Global field variables
        var polarAreaTitle;
        var histogramTitle;
        var lineGraphTitle;
        var scatterPlotTitle;
        
        var polarAreaTitleInput = "";
        var histogramTitleInput = "";
        var lineGraphTitleInput = "";
        var scatterPlotTitleInput = "";

        var lineGraphColor;


        // ---------------------------------------------------------------------------------

        // Generate all selected charts
        function generate() {
            if (document.getElementById('polarArea').checked) { 
                polarAreaTitleInput = document.getElementById('PAtitle').value;
                generatePolarArea(); }
            else { if (polarArea) { polarArea.destroy(); }}

            if (document.getElementById('histogram').checked) { 
                histogramTitleInput = document.getElementById('Htitle').value;
                generateHistogram(); }
            else { if (histogram) { histogram.destroy(); }}

            if(document.getElementById('lineGraph').checked) { 
                lineGraphTitleInput = document.getElementById('LGtitle').value;
                generateLineGraph(); }
            else { if (lineGraph) { lineGraph.destroy(); }}

            if(document.getElementById('scatterPlot').checked) { 
                scatterPlotTitleInput = document.getElementById('SPtitle').value;
                generateScatterPlot(); }
            else { if (scatterPlot) { scatterPlot.destroy(); }}
        }


        // Generate individual charts
        function generatePolarArea() {
            let chart = document.getElementById('pa').getContext('2d');

            polarArea = new Chart(chart, {
                type: 'polarArea',
                data: {
                    datasets: [{
                        data: [100, 20, 32, 68, 92, 44, 45], // dummy
                        backgroundColor: ['rgba(0, 0, 225, .1)', 'rgba(0, 0, 225, .2)', 'rgba(0, 0, 225, .4)', 'rgba(0, 0, 225, .6)', 'rgba(0, 0, 225, .8)', 'rgba(0, 0, 225, .9)', 'rgba(0, 0, 225, 1)'],
                        borderWidth: 1,
                        borderColor: '#777'
                    }]
                },
                options: {
                    title: {
                        display: true,
                        text: polarAreaTitleInput,
                        fontSize: 25
                    },
                    legend: {
                        display: false
                    },
                    tooltips: {
                        enabled: false
                    },
                    animation: {
                        onComplete: function() { console.log(polarArea.toBase64Image()); }
                    },
                    animation: false
                }
            });

            // Download
            console.log(polarArea.toBase64Image());
            var a = document.createElement('a');
            a.href = polarArea.toBase64Image();
            a.download = 'Polar_Area_Chart.png';

            a.click();
        }


        function generateHistogram() {
            let chart = document.getElementById('h').getContext('2d');

            histogram = new Chart(chart, {
                type: 'bar',
                data: {
                    datasets: [{
                        data: [100, 548, 230, 634, 203, 654, 29, 854, 583, 311, 230], // dummy
                        backgroundColor: 'rgba(0, 0, 225, .5)',
                        borderWidth: 1,
                        borderColor: '#777'
                    }]
                },
                options: {
                    title: {
                        display: true,
                        text: histogramTitleInput,
                        fontSize: 25
                    },
                    legend: {
                        display: false
                    },
                    tooltips: {
                        enabled: false
                    },
                    animation: false
                }
            });

            // Download
            console.log(histogram.toBase64Image());
            var a = document.createElement('a');
            a.href = histogram.toBase64Image();
            a.download = 'Histogram.png';

            a.click();
        }


        function generateLineGraph() {
            let chart = document.getElementById('lg').getContext('2d');

            lineGraph = new Chart(chart, {
                type: 'line',
                data: {
                    datasets: [{
                        data: [100, 200, 300, 45, 765, 352, 560, 548, 567, 432, 930, 968], // dummy
                        borderColor: ['rgba(0, 0, 225, .5)'],
                        fill: false
                    }]
                },
                options: {
                    title: {
                        display: true,
                        text: lineGraphTitleInput,
                        fontSize: 25
                    },
                    legend: {
                        display: false
                    },
                    tooltips: {
                        enabled: false
                    },
                    animation: false
                }
            });

            // Download
            console.log(lineGraph.toBase64Image());
            var a = document.createElement('a');
            a.href = lineGraph.toBase64Image();
            a.download = 'Line_Graph.png';

            a.click();
        }


        function generateScatterPlot() {
            let chart = document.getElementById('sp').getContext('2d');

            scatterPlot = new Chart(chart, {
                type: 'scatter',
                data: {
                    datasets: [{
                        data: [{x:100, y:100}, {x:26, y:05}, {x:12, y:42}, {x:73, y:92}, {x:17, y:25}, {x:97, y:82}, {x:27, y:86}, {x:45, y:56}, {x:93, y:34}, {x:23, y:45}], // dummy
                        backgroundColor: 'rgba(0, 0, 225, .5)',
                    }]
                },
                options: {
                    title: {
                        display: true,
                        text: scatterPlotTitleInput,
                        fontSize: 25
                    },
                    legend: {
                        display: false
                    },
                    tooltips: {
                        enabled: false
                    },
                    animation: false
                }
            });

            // Download
            console.log(scatterPlot.toBase64Image());
            var a = document.createElement('a');
            a.href = scatterPlot.toBase64Image();
            a.download = 'Scatter_Plot.png';

            a.click();
        }


        // ---------------------------------------------------------------------------------
        
        // Create required user input fields for each chart
        function createPolarAreaFields() {
            // Title
            if (!polarAreaTitle) {
                polarAreaTitle = document.createElement('div');
                polarAreaTitle.innerHTML = "<label for='title'>Title:</label><input type='text' id='PAtitle'>";
                document.getElementById("paTitle").appendChild(polarAreaTitle);
            }
            else { 
                polarAreaTitle.remove(); 
                polarAreaTitle = null;
            }

            // Color scheme
        }


        function createHistogramTitle() {
            // Title
            if (!histogramTitle) {
                histogramTitle = document.createElement('div');
                histogramTitle.innerHTML = "<label for='title'>Title:</label><input type='text' id='Htitle'>";
                document.getElementById("hTitle").appendChild(histogramTitle);
            }
            else { 
                histogramTitle.remove(); 
                histogramTitle = null;
            }

            // Color scheme
        }


        function createLineGraphFields() {
            // Title
            if (!lineGraphTitle) {
                lineGraphTitle = document.createElement('div');
                lineGraphTitle.innerHTML = "<label for='title'>Title:</label><input type='text' id='LGtitle'>";
                document.getElementById("lgTitle").appendChild(lineGraphTitle);
            }
            else { 
                lineGraphTitle.remove(); 
                lineGraphTitle = null;
            }

            // Color scheme
            if (!lineGraphColor) {
                
            }
        }


        function createScatterPlotFields() {
            // Title
            if (!scatterPlotTitle) {
                scatterPlotTitle = document.createElement('div');
                scatterPlotTitle.innerHTML = "<label for='title'>Title:</label><input type='text' id='SPtitle'>";
                document.getElementById("spTitle").appendChild(scatterPlotTitle);
            }
            else { 
                scatterPlotTitle.remove(); 
                scatterPlotTitle = null;
            }

            // Color scheme
        }

    </script>

</body>
